<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>JS + CSS Clock - Optimized</title>
  </head>
  <body>
    <div class="clock">
      <div class="clock-face">
        <div class="hand hour-hand"></div>
        <div class="hand min-hand"></div>
        <div class="hand second-hand"></div>
      </div>
    </div>

    <style>
      /* ... 外部样式基本不变 ... */
      html {
        background: #018ded
          url(https://random-image-api.bakacookie520.top/pc-dark/file_12.webp);
        background-size: cover;
        font-family: "helvetica neue";
        text-align: center;
        font-size: 10px;
      }

      body {
        font-size: 2rem;
        display: flex;
        flex: 1;
        min-height: 100vh;
        align-items: center;
        margin: 0;
        padding: 0;
      }

      .clock {
        width: 30rem;
        height: 30rem;
        border: 20px solid white;
        border-radius: 50%;
        margin: auto;
        position: relative;
        padding: 2rem;
        background-color: #ffffff4f;
      }
      .clock-face {
        position: relative;
        width: 100%;
        height: 100%;
      }
      .clock-face::before {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: block;
        content: "";
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background-color: #95c0d3;
        box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.169), 0 0 10px rgba(0, 0, 0, 0.2);
        z-index: 1;
      }

      /* 
       * CSS 优化点一：简化指针定位和旋转
       */
      .hand {
        position: absolute;
        /* 将所有指针的底部放在中心 */
        bottom: 50%; 
        left: 50%;
        /* 
         * 设置旋转中心为元素底部中点
         * transform-origin 的 x 轴 50% 是中点，y 轴 100% 是底部
         */
        transform-origin: 50% 100%;
        /* 使用 CSS 变量来统一管理旋转，子类只需改变这个变量的值 */
        transform: translateX(-50%) rotate(var(--rotation, 0deg));
        
        /* 
         * CSS 优化点二：为平滑过渡做准备 (可选)
         * 这会让指针的移动更平滑，而不是瞬间跳动
        */
        transition: transform 0.2s cubic-bezier(0.4, 2.5, 0.6, 1);
      }

      /* 当秒针从59秒跳到0秒时，我们不希望有过渡效果，否则它会逆时针扫一大圈 */
      .hand.no-transition {
          transition: none;
      }
      
      .hand.second-hand {
        width: 4px;
        height: 14rem;
        background-color: red;
        border-top-left-radius: 50%;
        border-top-right-radius: 50%;
      }
      .hand.min-hand {
        width: 5px;
        height: 14rem;
        background-color: #fff;
      }
      .hand.hour-hand {
        width: 8px;
        height: 6rem;
        background-color: rgba(0, 0, 255, 0.539);
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
      }
    </style>

    <script>
      const hourHandEl = document.querySelector(".hour-hand");
      const minHandEl = document.querySelector(".min-hand");
      const secondHandEl = document.querySelector(".second-hand");
      
      /**
       * JS 优化点一：将核心逻辑封装成函数
       */
      function setDate() {
        const now = new Date();

        const seconds = now.getSeconds();
        const secondsDegrees = seconds * 6; // 360 / 60 = 6
        
        const minutes = now.getMinutes();
        const minutesDegrees = minutes * 6 + seconds * 0.1; // 6 + 6/60
        
        const hours = now.getHours();
        // 确保小时在1-12之间
        const hoursDegrees = (hours % 12) * 30 + minutes * 0.5; // 30 + 30/60

        /**
         * JS 优化点二：修复秒针从 59 -> 0 的过渡动画 Bug
         * 当秒针归零时，我们暂时移除 transition，让它瞬间归位，然后再加回来
         */
        if (secondsDegrees === 0) {
            // 先添加 no-transition 类来禁用过渡
            secondHandEl.classList.add('no-transition');
            // 确保 DOM 更新，强制重绘
            void secondHandEl.offsetWidth; 
        } else {
            // 对于其他秒数，确保 no-transition 类被移除
            secondHandEl.classList.remove('no-transition');
        }

        // 使用 CSS 变量来设置旋转，而不是直接操作 transform
        hourHandEl.style.setProperty('--rotation', `${hoursDegrees}deg`);
        minHandEl.style.setProperty('--rotation', `${minutesDegrees}deg`);
        secondHandEl.style.setProperty('--rotation', `${secondsDegrees}deg`);
      }

      // JS 优化点三：页面加载后立即执行一次，避免指针从0度“跳”到当前时间
      setDate(); 
      setInterval(setDate, 1000);

    </script>
  </body>
</html>